<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01//EN" "http://www.w3.org/TR/html4/strict.dtd">
<html>
<head>
<title>World.java</title>
<meta http-equiv="content-type" content="text/html; charset=UTF-8">
<style type="text/css">
<!--
body {color: #000000; background-color: #ffffff; font-family: Courier New}
pre {color: #000000; background-color: #ffffff; font-family: Courier New}
table {color: #000000; background-color: #e9e8e2; font-family: Courier New}
.character {color: #ce7b00}
.keyword-directive {color: #0000e6}
.comment {color: #969696}
.line-number {background-color: #e9e8e2}
.ST0 {color: #969696; font-family: Courier New; font-weight: bold}
-->
</style>
</head>
<body>
<table width="100%"><tr><td align="center">World.java</td></tr></table>
<pre>
<span class="line-number">  1</span> <span class="keyword-directive">import</span> java.awt.BorderLayout;
<span class="line-number">  2</span> <span class="keyword-directive">import</span> java.awt.Color;
<span class="line-number">  3</span> <span class="keyword-directive">import</span> java.awt.Graphics;
<span class="line-number">  4</span> <span class="keyword-directive">import</span> java.awt.GridLayout;
<span class="line-number">  5</span> <span class="keyword-directive">import</span> java.awt.event.ActionEvent;
<span class="line-number">  6</span> <span class="keyword-directive">import</span> java.awt.event.ActionListener;
<span class="line-number">  7</span> <span class="keyword-directive">import</span> java.util.HashSet;
<span class="line-number">  8</span> <span class="keyword-directive">import</span> java.util.Random;
<span class="line-number">  9</span> <span class="keyword-directive">import</span> java.util.Set;
<span class="line-number"> 10</span> <span class="keyword-directive">import</span> javax.swing.JButton;
<span class="line-number"> 11</span> <span class="keyword-directive">import</span> javax.swing.JFrame;
<span class="line-number"> 12</span> <span class="keyword-directive">import</span> javax.swing.JLabel;
<span class="line-number"> 13</span> <span class="keyword-directive">import</span> javax.swing.JOptionPane;
<span class="line-number"> 14</span> <span class="keyword-directive">import</span> javax.swing.JPanel;
<span class="line-number"> 15</span> <span class="keyword-directive">import</span> javax.swing.JTextField;
<span class="line-number"> 16</span> <span class="keyword-directive">import</span> javax.swing.Timer;
<span class="line-number"> 17</span> 
<span class="line-number"> 18</span> <span class="comment">/**</span>
<span class="line-number"> 19</span> <span class="comment"> * </span><span class="comment">Runs</span> <span class="comment">game</span> <span class="comment">operations</span> <span class="comment">and</span> <span class="comment">handles</span> <span class="comment">graphics</span><span class="comment">.</span>  <span class="comment">Blocks</span> <span class="comment">that</span> <span class="comment">have</span> <span class="comment">already</span> <span class="comment">reached</span> 
<span class="line-number"> 20</span> <span class="comment"> * </span><span class="comment">the</span> <span class="comment">bottom</span> <span class="comment">are</span>
<span class="line-number"> 21</span> <span class="comment"> * </span><span class="comment">stored</span> <span class="comment">in</span> <span class="comment">a</span> <span class="comment">matrix</span> <span class="comment">representing</span> <span class="comment">the</span> <span class="comment">game</span><span class="comment">-</span><span class="comment">play</span> <span class="comment">grid</span><span class="comment">.</span>  <span class="comment">Blocks</span> <span class="comment">that</span> <span class="comment">are</span> <span class="comment">still</span>
<span class="line-number"> 22</span> <span class="comment"> * </span><span class="comment">in</span> <span class="comment">motion</span> <span class="comment">are</span> <span class="comment">stored</span> <span class="comment">by</span> <span class="comment">a</span> <span class="comment">single</span> <span class="comment">Tetra</span><span class="comment">, </span><span class="comment">their</span> <span class="comment">positions</span> <span class="comment">represented</span> <span class="comment">as</span> <span class="comment">part</span>
<span class="line-number"> 23</span> <span class="comment"> * </span><span class="comment">of</span> <span class="comment">a</span> <span class="comment">hypothetical</span> <span class="comment">grid</span><span class="comment">.</span> <span class="comment">Note</span><span class="comment">: </span><span class="comment">The</span> <span class="comment">Tetra</span> <span class="comment">that</span> <span class="comment">is</span> <span class="comment">currently</span> <span class="comment">in</span> <span class="comment">motion</span> <span class="comment">is</span>
<span class="line-number"> 24</span> <span class="comment"> * </span><span class="comment">referred</span> <span class="comment">to</span> <span class="comment">in</span> <span class="comment">comments</span> <span class="comment">as</span> <span class="comment">the</span><span class="comment"> &quot;</span><span class="comment">current</span> <span class="comment">Tetra</span><span class="comment">&quot;, </span><span class="comment">while</span> <span class="comment">the</span> <span class="comment">Blocks</span> <span class="comment">not</span> <span class="comment">in</span>
<span class="line-number"> 25</span> <span class="comment"> * </span><span class="comment">motion</span> <span class="comment">are</span> <span class="comment">referred</span> <span class="comment">to</span> <span class="comment">as</span> <span class="comment">the</span><span class="comment"> &quot;</span><span class="comment">pile</span><span class="comment">&quot;</span><span class="comment">.</span>
<span class="line-number"> 26</span> <span class="comment"> * </span><span class="ST0">@author</span> <span class="comment">Zach</span> <span class="comment">Cotter</span>
<span class="line-number"> 27</span>  <span class="comment">*/</span>
<span class="line-number"> 28</span> <span class="keyword-directive">public</span> <span class="keyword-directive">class</span> World <span class="keyword-directive">extends</span> JPanel {
<span class="line-number"> 29</span> 
<span class="line-number"> 30</span>     <span class="comment">//Game and Graphics Constants</span>
<span class="line-number"> 31</span>     <span class="keyword-directive">public</span> <span class="keyword-directive">static</span> <span class="keyword-directive">final</span> <span class="keyword-directive">int</span> GRID_HEIGHT = 20;
<span class="line-number"> 32</span>     <span class="keyword-directive">public</span> <span class="keyword-directive">static</span> <span class="keyword-directive">final</span> <span class="keyword-directive">int</span> GRID_WIDTH = 10;
<span class="line-number"> 33</span>     <span class="keyword-directive">public</span> <span class="keyword-directive">static</span> <span class="keyword-directive">final</span> <span class="keyword-directive">int</span> BLOCK_SIZE = 30;
<span class="line-number"> 34</span>     <span class="keyword-directive">public</span> <span class="keyword-directive">static</span> <span class="keyword-directive">final</span> <span class="keyword-directive">int</span> PANEL_WIDTH = BLOCK_SIZE * GRID_WIDTH;
<span class="line-number"> 35</span>     <span class="keyword-directive">public</span> <span class="keyword-directive">static</span> <span class="keyword-directive">final</span> <span class="keyword-directive">int</span> PANEL_HEIGHT = BLOCK_SIZE * GRID_HEIGHT;
<span class="line-number"> 36</span>     <span class="keyword-directive">private</span> <span class="keyword-directive">static</span> <span class="keyword-directive">final</span> <span class="keyword-directive">int</span> MAX_CHARS_ON_HIGH_SCORE_LINE = 23; <span class="comment">//includes score</span>
<span class="line-number"> 37</span>     <span class="keyword-directive">private</span> <span class="keyword-directive">static</span> <span class="keyword-directive">final</span> String PAUSE_TEXT = <span class="character">&quot;</span><span class="character">     Pause</span><span class="character">&quot;</span>;
<span class="line-number"> 38</span>     <span class="keyword-directive">private</span> <span class="keyword-directive">static</span> <span class="keyword-directive">final</span> String NEW_GAME_TEXT = <span class="character">&quot;</span><span class="character">  New Game</span><span class="character">&quot;</span>;
<span class="line-number"> 39</span>     <span class="keyword-directive">private</span> <span class="keyword-directive">static</span> <span class="keyword-directive">final</span> String CONTINUE_TEXT = <span class="character">&quot;</span><span class="character">   Continue</span><span class="character">&quot;</span>;
<span class="line-number"> 40</span>     <span class="keyword-directive">private</span> <span class="keyword-directive">static</span> <span class="keyword-directive">final</span> <span class="keyword-directive">int</span> TIMER_INITIAL_DELAY = 600;
<span class="line-number"> 41</span>     <span class="keyword-directive">private</span> <span class="keyword-directive">static</span> <span class="keyword-directive">final</span> <span class="keyword-directive">int</span> DEFAULT_COMPONENT_SEPARATOR = 10;
<span class="line-number"> 42</span>     <span class="keyword-directive">private</span> <span class="keyword-directive">static</span> <span class="keyword-directive">final</span> <span class="keyword-directive">float</span> SCORE_TEXT_FONT_SIZE = 20;
<span class="line-number"> 43</span>     <span class="keyword-directive">private</span> <span class="keyword-directive">static</span> <span class="keyword-directive">final</span> <span class="keyword-directive">int</span> SCORE_TEXT_X_LOCATION = 10;
<span class="line-number"> 44</span>     <span class="keyword-directive">private</span> <span class="keyword-directive">static</span> <span class="keyword-directive">final</span> <span class="keyword-directive">int</span> SCORE_TEXT_Y_LOCATION = 15;
<span class="line-number"> 45</span>     <span class="comment">//Velocity increases by 20 milliseconds per 1000 points, see below</span>
<span class="line-number"> 46</span>     <span class="keyword-directive">private</span> <span class="keyword-directive">static</span> <span class="keyword-directive">final</span> <span class="keyword-directive">int</span> TIMER_DELAY_DECREMENT_PER_THOUSAND_VALUE = 20;
<span class="line-number"> 47</span>     <span class="keyword-directive">private</span> <span class="keyword-directive">static</span> <span class="keyword-directive">final</span> Color BACKGROUND_COLOR = Color.WHITE;
<span class="line-number"> 48</span>     <span class="keyword-directive">private</span> <span class="keyword-directive">static</span> <span class="keyword-directive">final</span> Color FOREGROUND_COLOR = Color.BLACK;
<span class="line-number"> 49</span>     <span class="keyword-directive">private</span> <span class="keyword-directive">static</span> <span class="keyword-directive">final</span> <span class="keyword-directive">int</span> POINTS_PER_BLOCK = 10;
<span class="line-number"> 50</span>     <span class="keyword-directive">private</span> <span class="keyword-directive">static</span> <span class="keyword-directive">final</span> <span class="keyword-directive">int</span> POINTS_PER_TOTAL_CLEAR = 500;
<span class="line-number"> 51</span>     <span class="keyword-directive">private</span> <span class="keyword-directive">static</span> <span class="keyword-directive">final</span> <span class="keyword-directive">int</span> POINTS_PER_CLEAR = 100;
<span class="line-number"> 52</span> 
<span class="line-number"> 53</span>     <span class="comment">//Game and Graphics fields.</span>
<span class="line-number"> 54</span>     <span class="keyword-directive">private</span> Tetra current;
<span class="line-number"> 55</span>     <span class="keyword-directive">private</span> Timer timer;
<span class="line-number"> 56</span>     <span class="keyword-directive">private</span> Block[][] grid;
<span class="line-number"> 57</span>     <span class="keyword-directive">private</span> <span class="keyword-directive">boolean</span> gameOver;
<span class="line-number"> 58</span>     <span class="keyword-directive">private</span> <span class="keyword-directive">boolean</span> gameInProgress;
<span class="line-number"> 59</span>     <span class="keyword-directive">private</span> <span class="keyword-directive">boolean</span> paused;
<span class="line-number"> 60</span>     <span class="keyword-directive">private</span> <span class="keyword-directive">int</span> score;
<span class="line-number"> 61</span>     <span class="keyword-directive">private</span> <span class="keyword-directive">int</span> lastThousandForScore;
<span class="line-number"> 62</span>     <span class="keyword-directive">private</span> HighScore highScoreTable;
<span class="line-number"> 63</span>     <span class="keyword-directive">private</span> HighScoreFrame highScoreFrame;
<span class="line-number"> 64</span> 
<span class="line-number"> 65</span>     <span class="comment">/**</span>
<span class="line-number"> 66</span> <span class="comment">     * </span><span class="comment">Constructs</span> <span class="comment">a</span> <span class="comment">new</span> <span class="comment">world</span> <span class="comment">and</span> <span class="comment">waits</span> <span class="comment">for</span> <span class="comment">user</span> <span class="comment">interaction</span><span class="comment">.</span>
<span class="line-number"> 67</span>      <span class="comment">*/</span>
<span class="line-number"> 68</span>     <span class="keyword-directive">public</span> World() {
<span class="line-number"> 69</span>         gameInProgress = <span class="keyword-directive">false</span>;
<span class="line-number"> 70</span>         paused = <span class="keyword-directive">false</span>;
<span class="line-number"> 71</span>         highScoreTable = <span class="keyword-directive">new</span> HighScore();
<span class="line-number"> 72</span>         setUpGUI();
<span class="line-number"> 73</span>     }
<span class="line-number"> 74</span> 
<span class="line-number"> 75</span>     <span class="comment">/**</span>
<span class="line-number"> 76</span> <span class="comment">     * </span><span class="comment">Accessor</span> <span class="comment">for</span> <span class="comment">whether</span> <span class="comment">the</span> <span class="comment">game</span> <span class="comment">is</span> <span class="comment">in</span> <span class="comment">progress</span><span class="comment">.</span>
<span class="line-number"> 77</span> <span class="comment">     * </span><span class="comment">Note</span><span class="comment">: </span><span class="comment">the</span> <span class="comment">distinction</span> <span class="comment">between</span><span class="comment"> &quot;</span><span class="comment">not</span> <span class="comment">in</span> <span class="comment">progress</span><span class="comment">&quot;,</span>
<span class="line-number"> 78</span> <span class="comment">     * </span><span class="comment">and</span><span class="comment"> &quot;</span><span class="comment">paused</span><span class="comment">&quot; </span><span class="comment">occurs</span> <span class="comment">if</span> <span class="comment">the</span> <span class="comment">game</span> <span class="comment">has</span> <span class="comment">not</span> <span class="comment">started</span> <span class="comment">yet</span><span class="comment">.</span>
<span class="line-number"> 79</span> <span class="comment">     * </span><span class="ST0">@return</span> <span class="comment">true</span> <span class="comment">if</span> <span class="comment">in</span> <span class="comment">progress</span><span class="comment">, </span><span class="comment">false</span> <span class="comment">otherwise</span><span class="comment">.</span>
<span class="line-number"> 80</span>      <span class="comment">*/</span>
<span class="line-number"> 81</span>     <span class="keyword-directive">public</span> <span class="keyword-directive">boolean</span> isGameInProgress() {
<span class="line-number"> 82</span>         <span class="keyword-directive">return</span> gameInProgress;
<span class="line-number"> 83</span>     }
<span class="line-number"> 84</span> 
<span class="line-number"> 85</span>     <span class="comment">/**</span>
<span class="line-number"> 86</span> <span class="comment">     * </span><span class="comment">Accessor</span> <span class="comment">for</span> <span class="comment">whether</span> <span class="comment">the</span> <span class="comment">game</span> <span class="comment">is</span> <span class="comment">paused</span><span class="comment">.</span>
<span class="line-number"> 87</span> <span class="comment">     * </span><span class="ST0">@return</span> <span class="comment">true</span> <span class="comment">if</span> <span class="comment">paused</span><span class="comment">, </span><span class="comment">otherwise</span> <span class="comment">false</span>
<span class="line-number"> 88</span>      <span class="comment">*/</span>
<span class="line-number"> 89</span>     <span class="keyword-directive">public</span> <span class="keyword-directive">boolean</span> isPaused() {
<span class="line-number"> 90</span>         <span class="keyword-directive">return</span> paused;
<span class="line-number"> 91</span>     }
<span class="line-number"> 92</span> 
<span class="line-number"> 93</span>     <span class="comment">/**</span>
<span class="line-number"> 94</span> <span class="comment">     * </span><span class="comment">Starts</span> <span class="comment">a</span> <span class="comment">new</span> <span class="comment">game</span><span class="comment">.</span>
<span class="line-number"> 95</span>      <span class="comment">*/</span>
<span class="line-number"> 96</span>     <span class="keyword-directive">public</span> <span class="keyword-directive">void</span> startGame() {
<span class="line-number"> 97</span>         gameInProgress = <span class="keyword-directive">true</span>;
<span class="line-number"> 98</span>         paused = <span class="keyword-directive">false</span>;
<span class="line-number"> 99</span>         TetrisFrame.gameButton.setText(PAUSE_TEXT);
<span class="line-number">100</span>         current = generateTetra();
<span class="line-number">101</span> 
<span class="line-number">102</span>         gameOver = <span class="keyword-directive">false</span>;
<span class="line-number">103</span>         score = 0;
<span class="line-number">104</span>         lastThousandForScore = 0;
<span class="line-number">105</span>         grid = <span class="keyword-directive">new</span> Block[GRID_WIDTH][GRID_HEIGHT];
<span class="line-number">106</span>         <span class="keyword-directive">for</span> (<span class="keyword-directive">int</span> x = 0; x &lt; GRID_WIDTH; x++) {
<span class="line-number">107</span>             <span class="keyword-directive">for</span> (<span class="keyword-directive">int</span> y = 0; y &lt; GRID_HEIGHT; y++) {
<span class="line-number">108</span>                 grid[x][y] = <span class="keyword-directive">null</span>;
<span class="line-number">109</span>             }
<span class="line-number">110</span>         }
<span class="line-number">111</span>         timer = <span class="keyword-directive">new</span> Timer(TIMER_INITIAL_DELAY,
<span class="line-number">112</span>                           <span class="keyword-directive">new</span> TimerActionListener());
<span class="line-number">113</span>         timer.start();
<span class="line-number">114</span>         paintComponent(<span class="keyword-directive">this</span>.getGraphics());
<span class="line-number">115</span>     }
<span class="line-number">116</span> 
<span class="line-number">117</span>     <span class="comment">/**</span>
<span class="line-number">118</span> <span class="comment">     * </span><span class="comment">Sets</span> <span class="comment">up</span> <span class="comment">graphics</span> <span class="comment">components</span><span class="comment">.</span>
<span class="line-number">119</span>      <span class="comment">*/</span>
<span class="line-number">120</span>     <span class="keyword-directive">private</span> <span class="keyword-directive">void</span> setUpGUI() {
<span class="line-number">121</span>         <span class="keyword-directive">this</span>.setSize(PANEL_WIDTH,
<span class="line-number">122</span>                      PANEL_HEIGHT);
<span class="line-number">123</span>         <span class="keyword-directive">this</span>.setLayout(<span class="keyword-directive">new</span> BorderLayout());
<span class="line-number">124</span>         <span class="keyword-directive">this</span>.setPreferredSize(<span class="keyword-directive">this</span>.getSize());
<span class="line-number">125</span>         <span class="keyword-directive">this</span>.setFocusable(<span class="keyword-directive">true</span>);
<span class="line-number">126</span>         <span class="keyword-directive">this</span>.setBackground(BACKGROUND_COLOR);
<span class="line-number">127</span>         <span class="keyword-directive">this</span>.setDoubleBuffered(<span class="keyword-directive">true</span>);
<span class="line-number">128</span>         <span class="keyword-directive">this</span>.setVisible(<span class="keyword-directive">true</span>);
<span class="line-number">129</span>     }
<span class="line-number">130</span> 
<span class="line-number">131</span>     <span class="comment">/**</span>
<span class="line-number">132</span> <span class="comment">     * </span><span class="comment">Pauses</span> <span class="comment">the</span> <span class="comment">game</span> <span class="comment">on</span> <span class="comment">next</span> <span class="comment">paint</span>
<span class="line-number">133</span>      <span class="comment">*/</span>
<span class="line-number">134</span>     <span class="keyword-directive">public</span> <span class="keyword-directive">void</span> pause() {
<span class="line-number">135</span>         paused = <span class="keyword-directive">true</span>;
<span class="line-number">136</span>         TetrisFrame.gameButton.setText(CONTINUE_TEXT);
<span class="line-number">137</span>         timer.stop();
<span class="line-number">138</span>     }
<span class="line-number">139</span> 
<span class="line-number">140</span>     <span class="comment">/**</span>
<span class="line-number">141</span> <span class="comment">     * </span><span class="comment">Continues</span> <span class="comment">the</span> <span class="comment">game</span> <span class="comment">on</span> <span class="comment">next</span> <span class="comment">paint</span>
<span class="line-number">142</span>      <span class="comment">*/</span>
<span class="line-number">143</span>     <span class="keyword-directive">public</span> <span class="keyword-directive">void</span> unpause() {
<span class="line-number">144</span>         paused = <span class="keyword-directive">false</span>;
<span class="line-number">145</span>         TetrisFrame.gameButton.setText(PAUSE_TEXT);
<span class="line-number">146</span>         timer.start();
<span class="line-number">147</span>     }
<span class="line-number">148</span> 
<span class="line-number">149</span>     <span class="comment">/**</span>
<span class="line-number">150</span> <span class="comment">     * </span><span class="comment">Paints</span> <span class="comment">the</span> <span class="comment">score</span> <span class="comment">on</span> <span class="comment">the</span> <span class="comment">given</span> <span class="comment">Graphics</span>
<span class="line-number">151</span> <span class="comment">     * </span><span class="ST0">@param</span> <span class="comment">g</span> <span class="comment">Graphics</span> <span class="comment">the</span> <span class="comment">score</span> <span class="comment">will</span> <span class="comment">be</span> <span class="comment">painted</span> <span class="comment">on</span><span class="comment">.</span>
<span class="line-number">152</span>      <span class="comment">*/</span>
<span class="line-number">153</span>     <span class="keyword-directive">private</span> <span class="keyword-directive">void</span> paintScore(Graphics g) {
<span class="line-number">154</span>         g.setFont(g.getFont().deriveFont(SCORE_TEXT_FONT_SIZE));
<span class="line-number">155</span>         g.setColor(Color.GREEN);
<span class="line-number">156</span>         g.drawString(<span class="character">&quot;&quot;</span> + score,
<span class="line-number">157</span>                      SCORE_TEXT_X_LOCATION,
<span class="line-number">158</span>                      SCORE_TEXT_Y_LOCATION);
<span class="line-number">159</span>         <span class="keyword-directive">int</span> thousands = score / 1000;
<span class="line-number">160</span>         <span class="keyword-directive">if</span> (thousands &gt; lastThousandForScore) {
<span class="line-number">161</span>             lastThousandForScore = thousands;
<span class="line-number">162</span>             timer.setDelay(
<span class="line-number">163</span>                     timer.getDelay() - TIMER_DELAY_DECREMENT_PER_THOUSAND_VALUE);
<span class="line-number">164</span>         }
<span class="line-number">165</span>     }
<span class="line-number">166</span> 
<span class="line-number">167</span>     <span class="comment">/**</span>
<span class="line-number">168</span> <span class="comment">     * </span><span class="comment">Handles</span> <span class="comment">Timer</span> <span class="comment">events</span> <span class="comment">by</span> <span class="comment">passing</span> <span class="comment">them</span> <span class="comment">to</span> <span class="comment">the</span> <span class="comment">appropriate</span> <span class="comment">method</span><span class="comment">.</span>
<span class="line-number">169</span>      <span class="comment">*/</span>
<span class="line-number">170</span>     <span class="keyword-directive">public</span> <span class="keyword-directive">class</span> TimerActionListener <span class="keyword-directive">implements</span> ActionListener {
<span class="line-number">171</span> 
<span class="line-number">172</span>         <span class="comment">/**</span>
<span class="line-number">173</span> <span class="comment">         * </span><span class="comment">Calls</span> <span class="comment">World</span><span class="comment">.</span><span class="comment">throwStepAction</span><span class="comment">() </span><span class="comment">when</span> <span class="comment">the</span> <span class="comment">Timer</span> <span class="comment">throws</span> <span class="comment">an</span> <span class="comment">ActionEvent</span>
<span class="line-number">174</span> <span class="comment">         * </span><span class="ST0">@param</span> <span class="comment">e</span> <span class="comment">the</span> <span class="comment">ActionEvent</span> <span class="comment">thrown</span> <span class="comment">by</span> <span class="comment">the</span> <span class="comment">Timer</span><span class="comment">.</span>
<span class="line-number">175</span>          <span class="comment">*/</span>
<span class="line-number">176</span>         @Override
<span class="line-number">177</span>         <span class="keyword-directive">public</span> <span class="keyword-directive">void</span> actionPerformed(ActionEvent e) {
<span class="line-number">178</span>             throwStepAction();
<span class="line-number">179</span>         }
<span class="line-number">180</span>     }
<span class="line-number">181</span> 
<span class="line-number">182</span>     <span class="comment">/**</span>
<span class="line-number">183</span> <span class="comment">     * </span><span class="comment">Paints</span> <span class="comment">the</span> <span class="comment">entire</span> <span class="comment">panel</span><span class="comment">.</span>
<span class="line-number">184</span> <span class="comment">     * </span><span class="ST0">@param</span> <span class="comment">g</span> <span class="comment">Graphics</span> <span class="comment">to</span> <span class="comment">be</span> <span class="comment">painted</span> <span class="comment">on</span><span class="comment">.</span>
<span class="line-number">185</span>      <span class="comment">*/</span>
<span class="line-number">186</span>     @Override
<span class="line-number">187</span>     <span class="keyword-directive">protected</span> <span class="keyword-directive">void</span> paintComponent(Graphics g) {
<span class="line-number">188</span>         <span class="keyword-directive">if</span> (gameOver) {
<span class="line-number">189</span>             g.setFont(g.getFont().deriveFont((<span class="keyword-directive">float</span>) 80));
<span class="line-number">190</span>             g.setColor(FOREGROUND_COLOR);
<span class="line-number">191</span>             g.drawString(<span class="character">&quot;</span><span class="character"> GAME </span><span class="character">&quot;</span>,
<span class="line-number">192</span>                          DEFAULT_COMPONENT_SEPARATOR,
<span class="line-number">193</span>                          100);
<span class="line-number">194</span>             g.drawString(<span class="character">&quot;</span><span class="character"> OVER </span><span class="character">&quot;</span>,
<span class="line-number">195</span>                          DEFAULT_COMPONENT_SEPARATOR,
<span class="line-number">196</span>                          200);
<span class="line-number">197</span>             TetrisFrame.gameButton.setText(NEW_GAME_TEXT);
<span class="line-number">198</span>         }
<span class="line-number">199</span>         <span class="keyword-directive">if</span> (gameInProgress) {
<span class="line-number">200</span>             current.paint(g);
<span class="line-number">201</span>             paintEmpties(g);
<span class="line-number">202</span>             paintPile(g);
<span class="line-number">203</span>         }
<span class="line-number">204</span>     }
<span class="line-number">205</span> 
<span class="line-number">206</span>     <span class="comment">/**</span>
<span class="line-number">207</span> <span class="comment">     * </span><span class="comment">Paints</span> <span class="comment">spaces</span> <span class="comment">not</span> <span class="comment">occupied</span> <span class="comment">by</span> <span class="comment">Blocks</span> <span class="comment">in</span> <span class="comment">the</span> <span class="comment">pile</span>
<span class="line-number">208</span> <span class="comment">     * </span><span class="ST0">@param</span> <span class="comment">g</span> <span class="comment">Graphics</span> <span class="comment">to</span> <span class="comment">paint</span> <span class="comment">on</span><span class="comment">.</span>
<span class="line-number">209</span>      <span class="comment">*/</span>
<span class="line-number">210</span>     <span class="keyword-directive">private</span> <span class="keyword-directive">void</span> paintEmpties(Graphics g) {
<span class="line-number">211</span>         g.setColor(BACKGROUND_COLOR);
<span class="line-number">212</span>         <span class="keyword-directive">for</span> (<span class="keyword-directive">int</span> x = 0; x &lt; GRID_WIDTH; x++) {
<span class="line-number">213</span>             <span class="keyword-directive">for</span> (<span class="keyword-directive">int</span> y = 0; y &lt; GRID_HEIGHT; y++) {
<span class="line-number">214</span>                 <span class="keyword-directive">if</span> (grid[x][y] == <span class="keyword-directive">null</span>) {
<span class="line-number">215</span>                     g.fillRect(x * BLOCK_SIZE,
<span class="line-number">216</span>                                y * BLOCK_SIZE,
<span class="line-number">217</span>                                BLOCK_SIZE,
<span class="line-number">218</span>                                BLOCK_SIZE);
<span class="line-number">219</span>                 }
<span class="line-number">220</span>             }
<span class="line-number">221</span>         }
<span class="line-number">222</span>     }
<span class="line-number">223</span> 
<span class="line-number">224</span>     <span class="comment">/**</span>
<span class="line-number">225</span> <span class="comment">     * </span><span class="comment">Paints</span> <span class="comment">spaces</span> <span class="comment">occupied</span> <span class="comment">by</span> <span class="comment">Blocks</span> <span class="comment">in</span> <span class="comment">the</span> <span class="comment">pile</span><span class="comment">.</span>
<span class="line-number">226</span> <span class="comment">     * </span><span class="ST0">@param</span> <span class="comment">g</span> <span class="comment">Graphics</span> <span class="comment">to</span> <span class="comment">paint</span> <span class="comment">on</span><span class="comment">.</span>
<span class="line-number">227</span>      <span class="comment">*/</span>
<span class="line-number">228</span>     <span class="keyword-directive">private</span> <span class="keyword-directive">void</span> paintPile(Graphics g) {
<span class="line-number">229</span>         <span class="keyword-directive">for</span> (<span class="keyword-directive">int</span> x = 0; x &lt; GRID_WIDTH; x++) {
<span class="line-number">230</span>             <span class="keyword-directive">for</span> (<span class="keyword-directive">int</span> y = 0; y &lt; GRID_HEIGHT; y++) {
<span class="line-number">231</span>                 <span class="keyword-directive">if</span> (grid[x][y] != <span class="keyword-directive">null</span>) {
<span class="line-number">232</span>                     grid[x][y].paint(g);
<span class="line-number">233</span>                 }
<span class="line-number">234</span>             }
<span class="line-number">235</span>         }
<span class="line-number">236</span>         paintScore(g);
<span class="line-number">237</span>     }
<span class="line-number">238</span> 
<span class="line-number">239</span>     <span class="comment">/**</span>
<span class="line-number">240</span> <span class="comment">     * </span><span class="comment">Paints</span> <span class="comment">spaces</span> <span class="comment">occupied</span> <span class="comment">by</span> <span class="comment">the</span> <span class="comment">Blocks</span> <span class="comment">of</span> <span class="comment">the</span> <span class="comment">provided</span> <span class="comment">Tetra</span> <span class="comment">the</span> <span class="comment">background</span>
<span class="line-number">241</span> <span class="comment">     * </span><span class="comment">color</span><span class="comment">, </span><span class="comment">then</span> <span class="comment">paints</span> <span class="comment">spaces</span> <span class="comment">occupied</span> <span class="comment">by</span> <span class="comment">currently</span> <span class="comment">falling</span> <span class="comment">Tetra</span> <span class="comment">appropriately</span><span class="comment">.</span>
<span class="line-number">242</span> <span class="comment">     * </span><span class="comment">Intended</span> <span class="comment">to</span> <span class="comment">minimize</span> <span class="comment">flickering</span> <span class="comment">from</span> <span class="comment">excessive</span> <span class="comment">painting</span><span class="comment">, </span><span class="comment">so</span> <span class="comment">it</span> <span class="comment">should</span>
<span class="line-number">243</span> <span class="comment">     * </span><span class="comment">be</span> <span class="comment">called</span> <span class="comment">if</span> <span class="comment">nothing</span> <span class="comment">changes</span> <span class="comment">except</span> <span class="comment">the</span> <span class="comment">position</span> <span class="comment">of</span> <span class="comment">the</span> <span class="comment">current</span> <span class="comment">tetra</span><span class="comment">.</span>
<span class="line-number">244</span> <span class="comment">     * </span><span class="ST0">@param</span> <span class="comment">oldTetra</span> <span class="comment">Tetra</span> <span class="comment">containing</span> <span class="comment">Blocks</span> <span class="comment">who</span><span class="comment">&#39;</span><span class="comment">s</span> <span class="comment">spaces</span> <span class="comment">will</span> <span class="comment">be</span> <span class="comment">erased</span><span class="comment">.</span>
<span class="line-number">245</span>      <span class="comment">*/</span>
<span class="line-number">246</span>     <span class="keyword-directive">private</span> <span class="keyword-directive">void</span> paintCurrent(Tetra oldTetra) {
<span class="line-number">247</span>         HashSet&lt;Block&gt; allBlocks = <span class="keyword-directive">new</span> HashSet&lt;Block&gt;();
<span class="line-number">248</span>         allBlocks.addAll(current.getTetra());
<span class="line-number">249</span>         allBlocks.addAll(oldTetra.getTetra());
<span class="line-number">250</span>         <span class="keyword-directive">if</span> (current.getTetra().size() == allBlocks.size()) {
<span class="line-number">251</span>             <span class="keyword-directive">return</span>;
<span class="line-number">252</span>         }
<span class="line-number">253</span>         <span class="keyword-directive">for</span> (Block b : allBlocks) {
<span class="line-number">254</span>             <span class="keyword-directive">boolean</span> occupied = setContains(current.getTetra(),
<span class="line-number">255</span>                                            b);
<span class="line-number">256</span>             <span class="keyword-directive">if</span> (occupied) {
<span class="line-number">257</span>                 b.paint(<span class="keyword-directive">this</span>.getGraphics());
<span class="line-number">258</span>             }
<span class="line-number">259</span>             <span class="keyword-directive">else</span> {
<span class="line-number">260</span>                 b.paintAsEmpty(<span class="keyword-directive">this</span>.getGraphics());
<span class="line-number">261</span>             }
<span class="line-number">262</span>         }
<span class="line-number">263</span>     }
<span class="line-number">264</span> 
<span class="line-number">265</span>     <span class="comment">/**</span>
<span class="line-number">266</span> <span class="comment">     * </span><span class="comment">Adds</span> <span class="comment">the</span> <span class="comment">current</span> <span class="comment">Tetra</span> <span class="comment">to</span> <span class="comment">the</span> <span class="comment">pile</span><span class="comment">, </span><span class="comment">then</span> <span class="comment">processes</span> <span class="comment">the</span> <span class="comment">pile</span><span class="comment">.</span>
<span class="line-number">267</span>      <span class="comment">*/</span>
<span class="line-number">268</span>     <span class="keyword-directive">private</span> <span class="keyword-directive">void</span> addCurrentToPile() {
<span class="line-number">269</span>         <span class="keyword-directive">for</span> (Block b : current.getTetra()) {
<span class="line-number">270</span>             grid[b.getX()][b.getY()] = b;
<span class="line-number">271</span>             score += POINTS_PER_BLOCK;
<span class="line-number">272</span>         }
<span class="line-number">273</span>         dumpFullRows();
<span class="line-number">274</span>         checkGridEmptyForScore();
<span class="line-number">275</span>         paintComponent(<span class="keyword-directive">this</span>.getGraphics());
<span class="line-number">276</span>     }
<span class="line-number">277</span> 
<span class="line-number">278</span>     <span class="comment">/**</span>
<span class="line-number">279</span> <span class="comment">     * </span><span class="comment">Determines</span> <span class="comment">if</span> <span class="comment">there</span> <span class="comment">are</span> <span class="comment">no</span> <span class="comment">blocks</span> <span class="comment">in</span> <span class="comment">the</span> <span class="comment">grid</span> <span class="comment">for</span> <span class="comment">scoring</span> <span class="comment">purposes</span><span class="comment">.</span>
<span class="line-number">280</span>      <span class="comment">*/</span>
<span class="line-number">281</span>     <span class="keyword-directive">private</span> <span class="keyword-directive">void</span> checkGridEmptyForScore() {
<span class="line-number">282</span>         <span class="keyword-directive">boolean</span> emptyGrid = <span class="keyword-directive">true</span>;
<span class="line-number">283</span>         <span class="keyword-directive">for</span> (<span class="keyword-directive">int</span> y = 0; y &lt; GRID_HEIGHT; y++) {
<span class="line-number">284</span>             <span class="keyword-directive">for</span> (<span class="keyword-directive">int</span> x = 0; x &lt; GRID_WIDTH; x++) {
<span class="line-number">285</span>                 <span class="keyword-directive">if</span> (grid[x][y] != <span class="keyword-directive">null</span>) {
<span class="line-number">286</span>                     emptyGrid = <span class="keyword-directive">false</span>;
<span class="line-number">287</span>                     <span class="keyword-directive">break</span>;
<span class="line-number">288</span>                 }
<span class="line-number">289</span>             }
<span class="line-number">290</span>             <span class="keyword-directive">if</span> (!emptyGrid) {
<span class="line-number">291</span>                 <span class="keyword-directive">break</span>;
<span class="line-number">292</span>             }
<span class="line-number">293</span>         }
<span class="line-number">294</span>         <span class="keyword-directive">if</span> (emptyGrid) {
<span class="line-number">295</span>             score += POINTS_PER_TOTAL_CLEAR;
<span class="line-number">296</span>         }
<span class="line-number">297</span>     }
<span class="line-number">298</span> 
<span class="line-number">299</span>     <span class="comment">/**</span>
<span class="line-number">300</span> <span class="comment">     * </span><span class="comment">Erases</span> <span class="comment">rows</span> <span class="comment">of</span> <span class="comment">the</span> <span class="comment">grid</span> <span class="comment">that</span> <span class="comment">are</span> <span class="comment">full</span> <span class="comment">and</span> <span class="comment">moves</span> <span class="comment">rows</span> <span class="comment">above</span> <span class="comment">down</span> <span class="comment">as</span> <span class="comment">needed</span><span class="comment">.</span>
<span class="line-number">301</span>      <span class="comment">*/</span>
<span class="line-number">302</span>     <span class="keyword-directive">private</span> <span class="keyword-directive">void</span> dumpFullRows() {
<span class="line-number">303</span>         <span class="keyword-directive">for</span> (<span class="keyword-directive">int</span> y = 0; y &lt; GRID_HEIGHT; y++) {
<span class="line-number">304</span>             <span class="keyword-directive">boolean</span> rowFull = <span class="keyword-directive">true</span>;
<span class="line-number">305</span>             <span class="keyword-directive">for</span> (<span class="keyword-directive">int</span> x = 0; x &lt; GRID_WIDTH; x++) {
<span class="line-number">306</span>                 <span class="keyword-directive">if</span> (grid[x][y] == <span class="keyword-directive">null</span>) {
<span class="line-number">307</span>                     rowFull = <span class="keyword-directive">false</span>;
<span class="line-number">308</span>                     <span class="keyword-directive">break</span>;
<span class="line-number">309</span>                 }
<span class="line-number">310</span>             }
<span class="line-number">311</span>             <span class="keyword-directive">if</span> (rowFull) {
<span class="line-number">312</span>                 deleteRow(y);
<span class="line-number">313</span>                 score += POINTS_PER_CLEAR;
<span class="line-number">314</span>             }
<span class="line-number">315</span>         }
<span class="line-number">316</span>     }
<span class="line-number">317</span> 
<span class="line-number">318</span>     <span class="comment">/**</span>
<span class="line-number">319</span> <span class="comment">     * </span><span class="comment">Shifts</span> <span class="comment">all</span> <span class="comment">rows</span> <span class="comment">above</span> <span class="comment">the</span> <span class="comment">given</span> <span class="comment">row</span> <span class="comment">down</span> <span class="comment">one</span><span class="comment">.</span>
<span class="line-number">320</span> <span class="comment">     * </span><span class="ST0">@param</span> <span class="comment">row</span> <span class="comment">int</span> <span class="comment">representing</span> <span class="comment">highest</span> <span class="comment">row</span> <span class="comment">that</span> <span class="comment">is</span> <span class="comment">not</span> <span class="comment">moved</span> <span class="comment">down</span><span class="comment">.</span>
<span class="line-number">321</span>      <span class="comment">*/</span>
<span class="line-number">322</span>     <span class="keyword-directive">private</span> <span class="keyword-directive">void</span> shiftAllAboveDownOne(<span class="keyword-directive">int</span> row) {
<span class="line-number">323</span>         <span class="keyword-directive">for</span> (<span class="keyword-directive">int</span> y = row; y &gt;= 0; y--) {
<span class="line-number">324</span>             <span class="keyword-directive">for</span> (<span class="keyword-directive">int</span> x = 0; x &lt; GRID_WIDTH; x++) {
<span class="line-number">325</span>                 <span class="keyword-directive">if</span> (grid[x][y] != <span class="keyword-directive">null</span>) {
<span class="line-number">326</span>                     grid[x][y].moveDown();
<span class="line-number">327</span>                     grid[x][y + 1] = grid[x][y];
<span class="line-number">328</span>                     grid[x][y] = <span class="keyword-directive">null</span>;
<span class="line-number">329</span>                 }
<span class="line-number">330</span>             }
<span class="line-number">331</span>         }
<span class="line-number">332</span>     }
<span class="line-number">333</span> 
<span class="line-number">334</span>     <span class="comment">/**</span>
<span class="line-number">335</span> <span class="comment">     * </span><span class="comment">Deletes</span> <span class="comment">the</span> <span class="comment">given</span> <span class="comment">row</span> <span class="comment">and</span> <span class="comment">moves</span> <span class="comment">all</span> <span class="comment">rows</span> <span class="comment">above</span> <span class="comment">it</span> <span class="comment">down</span> <span class="comment">by</span> <span class="comment">one</span><span class="comment">.</span>
<span class="line-number">336</span> <span class="comment">     * </span><span class="ST0">@param</span> <span class="comment">row</span> <span class="comment">int</span> <span class="comment">representing</span> <span class="comment">row</span> <span class="comment">to</span> <span class="comment">delete</span><span class="comment">.</span>
<span class="line-number">337</span>      <span class="comment">*/</span>
<span class="line-number">338</span>     <span class="keyword-directive">private</span> <span class="keyword-directive">void</span> deleteRow(<span class="keyword-directive">int</span> row) {
<span class="line-number">339</span>         <span class="keyword-directive">for</span> (<span class="keyword-directive">int</span> x = 0; x &lt; GRID_WIDTH; x++) {
<span class="line-number">340</span>             grid[x][row] = <span class="keyword-directive">null</span>;
<span class="line-number">341</span>         }
<span class="line-number">342</span>         shiftAllAboveDownOne(row);
<span class="line-number">343</span>     }
<span class="line-number">344</span> 
<span class="line-number">345</span>     <span class="comment">/**</span>
<span class="line-number">346</span> <span class="comment">     * </span><span class="comment">Determines</span> <span class="comment">if</span> <span class="comment">the</span> <span class="comment">blocks</span> <span class="comment">in</span> <span class="comment">motion</span> <span class="comment">have</span> <span class="comment">collided</span> <span class="comment">with</span>
<span class="line-number">347</span> <span class="comment">     * </span><span class="comment">stationary</span> <span class="comment">blocks</span><span class="comment">.</span>
<span class="line-number">348</span> <span class="comment">     * </span><span class="ST0">@return</span> <span class="comment">Whether</span> <span class="comment">or</span> <span class="comment">not</span> <span class="comment">a</span> <span class="comment">collision</span> <span class="comment">is</span> <span class="comment">taking</span> <span class="comment">place</span><span class="comment">.</span>
<span class="line-number">349</span>      <span class="comment">*/</span>
<span class="line-number">350</span>     <span class="keyword-directive">private</span> <span class="keyword-directive">boolean</span> checkIfCurrentIntersectsPile() {
<span class="line-number">351</span>         <span class="keyword-directive">boolean</span> overlap = <span class="keyword-directive">false</span>;
<span class="line-number">352</span>         <span class="keyword-directive">for</span> (<span class="keyword-directive">int</span> x = 0; x &lt; GRID_WIDTH; x++) {
<span class="line-number">353</span>             <span class="keyword-directive">for</span> (<span class="keyword-directive">int</span> y = 0; y &lt; GRID_HEIGHT; y++) {
<span class="line-number">354</span>                 <span class="keyword-directive">if</span> (grid[x][y] != <span class="keyword-directive">null</span>) {
<span class="line-number">355</span>                     <span class="keyword-directive">for</span> (Block b : current.getTetra()) {
<span class="line-number">356</span>                         <span class="keyword-directive">if</span> (b.equals(grid[x][y])) {
<span class="line-number">357</span>                             overlap = <span class="keyword-directive">true</span>;
<span class="line-number">358</span>                             <span class="keyword-directive">break</span>;
<span class="line-number">359</span>                         }
<span class="line-number">360</span>                     }
<span class="line-number">361</span>                 }
<span class="line-number">362</span>                 <span class="keyword-directive">if</span> (overlap == <span class="keyword-directive">true</span>) {
<span class="line-number">363</span>                     <span class="keyword-directive">break</span>;
<span class="line-number">364</span>                 }
<span class="line-number">365</span>             }
<span class="line-number">366</span>             <span class="keyword-directive">if</span> (overlap == <span class="keyword-directive">true</span>) {
<span class="line-number">367</span>                 <span class="keyword-directive">break</span>;
<span class="line-number">368</span>             }
<span class="line-number">369</span>         }
<span class="line-number">370</span>         <span class="keyword-directive">return</span> overlap;
<span class="line-number">371</span>     }
<span class="line-number">372</span> 
<span class="line-number">373</span>     <span class="comment">/**</span>
<span class="line-number">374</span> <span class="comment">     * </span><span class="comment">Determines</span> <span class="comment">if</span> <span class="comment">blocks</span> <span class="comment">are</span> <span class="comment">present</span> <span class="comment">in</span> <span class="comment">the</span> <span class="comment">top</span> <span class="comment">most</span> <span class="comment">row</span> <span class="comment">of</span> <span class="comment">the</span> <span class="comment">game</span><span class="comment">-</span><span class="comment">play</span>
<span class="line-number">375</span> <span class="comment">     * </span><span class="comment">grid</span><span class="comment">, </span><span class="comment">and</span> <span class="comment">if</span> <span class="comment">so</span> <span class="comment">responds</span> <span class="comment">appropriately</span><span class="comment">.</span>
<span class="line-number">376</span>      <span class="comment">*/</span>
<span class="line-number">377</span>     <span class="keyword-directive">private</span> <span class="keyword-directive">void</span> checkGameOver() {
<span class="line-number">378</span>         <span class="keyword-directive">for</span> (<span class="keyword-directive">int</span> x = 0; x &lt; GRID_WIDTH; x++) {
<span class="line-number">379</span>             <span class="keyword-directive">if</span> (grid[x][0] != <span class="keyword-directive">null</span>) {
<span class="line-number">380</span>                 gameOver = <span class="keyword-directive">true</span>;
<span class="line-number">381</span>                 checkHighScorer();
<span class="line-number">382</span>                 pause();
<span class="line-number">383</span>                 gameInProgress = <span class="keyword-directive">false</span>;
<span class="line-number">384</span>                 TetrisFrame.gameButton.setText(NEW_GAME_TEXT);
<span class="line-number">385</span>             }
<span class="line-number">386</span>         }
<span class="line-number">387</span>     }
<span class="line-number">388</span> 
<span class="line-number">389</span>     <span class="comment">/**</span>
<span class="line-number">390</span> <span class="comment">     * </span><span class="comment">Abstracts</span> <span class="comment">singular</span> <span class="comment">horizontal</span> <span class="comment">and</span> <span class="comment">vertical</span> <span class="comment">movements</span> <span class="comment">of</span> <span class="comment">the</span> <span class="comment">Tetra</span>
<span class="line-number">391</span> <span class="comment">     * </span><span class="comment">currently</span> <span class="comment">in</span> <span class="comment">motion</span><span class="comment">.</span> <span class="comment">Parameter</span> <span class="comment">indicates</span> <span class="comment">lateral</span> <span class="comment">offset</span> <span class="comment">of</span> <span class="comment">target</span>
<span class="line-number">392</span> <span class="comment">     * </span><span class="comment">location</span><span class="comment">.</span> <span class="comment">A</span> <span class="comment">movement</span> <span class="comment">is</span> <span class="comment">made</span> <span class="comment">if</span> <span class="comment">and</span> <span class="comment">only</span> <span class="comment">if</span> <span class="comment">all</span> <span class="comment">Blocks</span> <span class="comment">of</span> <span class="comment">the</span> <span class="comment">Tetra</span>
<span class="line-number">393</span> <span class="comment">     * </span><span class="comment">currently</span> <span class="comment">in</span> <span class="comment">motion</span> <span class="comment">can</span> <span class="comment">complete</span> <span class="comment">the</span> <span class="comment">motion</span> <span class="comment">in</span> <span class="comment">the</span> <span class="comment">same</span> <span class="comment">direction</span><span class="comment">.</span>
<span class="line-number">394</span> <span class="comment">     * </span><span class="ST0">@param</span> <span class="comment">direction</span> <span class="comment">int</span> <span class="comment">representing</span> <span class="comment">lateral</span> <span class="comment">offset</span> <span class="comment">of</span> <span class="comment">target</span> <span class="comment">location</span>
<span class="line-number">395</span> <span class="comment">     * (</span><span class="comment">ie</span><span class="comment"> -1==</span><span class="comment">left</span><span class="comment">, 0==</span><span class="comment">done</span><span class="comment">, 1==</span><span class="comment">right</span><span class="comment">)</span>
<span class="line-number">396</span> <span class="comment">     * </span><span class="ST0">@return</span> <span class="comment">whether</span> <span class="comment">or</span> <span class="comment">not</span> <span class="comment">movement</span> <span class="comment">was</span> <span class="comment">successful</span>
<span class="line-number">397</span>      <span class="comment">*/</span>
<span class="line-number">398</span>     <span class="keyword-directive">private</span> <span class="keyword-directive">boolean</span> attemptToMoveCurrent(<span class="keyword-directive">int</span> direction) {
<span class="line-number">399</span>         <span class="keyword-directive">boolean</span> possible = <span class="keyword-directive">true</span>;
<span class="line-number">400</span>         <span class="keyword-directive">boolean</span> putInPile = <span class="keyword-directive">false</span>;
<span class="line-number">401</span>         <span class="comment">/*</span>
<span class="line-number">402</span> <span class="comment">         * For each block in the tetra, the new x and y positions are</span>
<span class="line-number">403</span> <span class="comment">         * determined by separately.</span>
<span class="line-number">404</span> <span class="comment">         */</span>
<span class="line-number">405</span>         <span class="keyword-directive">for</span> (Block b : current.getTetra()) {
<span class="line-number">406</span>             <span class="keyword-directive">int</span> currentX = b.getX();
<span class="line-number">407</span>             <span class="keyword-directive">int</span> currentY = b.getY();
<span class="line-number">408</span>             <span class="keyword-directive">int</span> targetX = currentX + direction;
<span class="line-number">409</span>             <span class="keyword-directive">int</span> targetY = -1;
<span class="line-number">410</span>             <span class="keyword-directive">if</span> (direction == 0) {
<span class="line-number">411</span>                 targetY = currentY + 1;
<span class="line-number">412</span>             }
<span class="line-number">413</span>             <span class="keyword-directive">else</span> {
<span class="line-number">414</span>                 targetY = currentY;
<span class="line-number">415</span>             }
<span class="line-number">416</span>             <span class="keyword-directive">if</span> (TetrisFrame.inbounds(targetX,
<span class="line-number">417</span>                                      targetY)) {
<span class="line-number">418</span>                 <span class="keyword-directive">boolean</span> filled = (grid[targetX][targetY] != <span class="keyword-directive">null</span>);
<span class="line-number">419</span>                 <span class="keyword-directive">if</span> (filled) {
<span class="line-number">420</span>                     possible = <span class="keyword-directive">false</span>;
<span class="line-number">421</span>                     <span class="keyword-directive">if</span> (direction == 0) {
<span class="line-number">422</span>                         putInPile = <span class="keyword-directive">true</span>;
<span class="line-number">423</span>                     }
<span class="line-number">424</span>                 }
<span class="line-number">425</span> 
<span class="line-number">426</span>             }
<span class="line-number">427</span>             <span class="keyword-directive">else</span> {
<span class="line-number">428</span>                 possible = <span class="keyword-directive">false</span>;
<span class="line-number">429</span>             }
<span class="line-number">430</span>             <span class="keyword-directive">if</span> (!((targetY &gt;= 0) &amp;&amp; (targetY &lt; 20))) {
<span class="line-number">431</span>                 putInPile = <span class="keyword-directive">true</span>;
<span class="line-number">432</span>             }
<span class="line-number">433</span>         }
<span class="line-number">434</span>         <span class="keyword-directive">if</span> (possible) {
<span class="line-number">435</span>             <span class="keyword-directive">if</span> (direction == 0) {
<span class="line-number">436</span>                 current.moveDown();
<span class="line-number">437</span>             }
<span class="line-number">438</span>             <span class="keyword-directive">if</span> (direction == 1) {
<span class="line-number">439</span>                 current.moveRight();
<span class="line-number">440</span>             }
<span class="line-number">441</span>             <span class="keyword-directive">if</span> (direction == -1) {
<span class="line-number">442</span>                 current.moveLeft();
<span class="line-number">443</span>             }
<span class="line-number">444</span>             <span class="keyword-directive">return</span> <span class="keyword-directive">true</span>;
<span class="line-number">445</span>         }
<span class="line-number">446</span>         <span class="keyword-directive">else</span> <span class="keyword-directive">if</span> (putInPile) {
<span class="line-number">447</span>             addCurrentToPile();
<span class="line-number">448</span>             current = generateTetra();
<span class="line-number">449</span>             paintCurrent(current);
<span class="line-number">450</span>             <span class="keyword-directive">return</span> <span class="keyword-directive">false</span>;
<span class="line-number">451</span>         }
<span class="line-number">452</span>         <span class="keyword-directive">else</span> {
<span class="line-number">453</span>             <span class="keyword-directive">return</span> <span class="keyword-directive">false</span>;
<span class="line-number">454</span>         }
<span class="line-number">455</span>     }
<span class="line-number">456</span> 
<span class="line-number">457</span>     <span class="comment">/**</span>
<span class="line-number">458</span> <span class="comment">     * </span><span class="comment">Recursively</span> <span class="comment">moves</span> <span class="comment">the</span> <span class="comment">Tetra</span> <span class="comment">currently</span> <span class="comment">in</span> <span class="comment">motion</span> <span class="comment">down</span> <span class="comment">until</span> <span class="comment">it</span> <span class="comment">can</span>
<span class="line-number">459</span> <span class="comment">     * </span><span class="comment">no</span> <span class="comment">longer</span><span class="comment">.</span>
<span class="line-number">460</span> <span class="comment">     * </span><span class="ST0">@return</span> <span class="comment">always</span> <span class="comment">returns</span> <span class="comment">false</span><span class="comment">.</span>
<span class="line-number">461</span>      <span class="comment">*/</span>
<span class="line-number">462</span>     <span class="keyword-directive">private</span> <span class="keyword-directive">boolean</span> attemptToMoveCurrentToMaximumDownwardPosition() {
<span class="line-number">463</span>         <span class="keyword-directive">boolean</span> keepGoing = <span class="keyword-directive">true</span>;
<span class="line-number">464</span>         <span class="keyword-directive">while</span> (keepGoing) {
<span class="line-number">465</span>             keepGoing = attemptToMoveCurrentDown();
<span class="line-number">466</span>         }
<span class="line-number">467</span>         <span class="keyword-directive">return</span> keepGoing;
<span class="line-number">468</span>     }
<span class="line-number">469</span> 
<span class="line-number">470</span>     <span class="comment">/**</span>
<span class="line-number">471</span> <span class="comment">     * </span><span class="comment">Rotates</span> <span class="comment">the</span> <span class="comment">tetra</span> <span class="comment">currently</span> <span class="comment">in</span> <span class="comment">motion</span> <span class="comment">if</span> <span class="comment">possible</span><span class="comment">.</span> 
<span class="line-number">472</span> <span class="comment">     * </span><span class="ST0">@param</span> <span class="comment">clockwise</span> <span class="comment">whether</span> <span class="comment">or</span> <span class="comment">not</span> <span class="comment">the</span> <span class="comment">rotation</span> <span class="comment">is</span> <span class="comment">clockwise</span>
<span class="line-number">473</span> <span class="comment">     * </span><span class="ST0">@return</span> <span class="comment">whether</span> <span class="comment">or</span> <span class="comment">not</span> <span class="comment">a</span> <span class="comment">rotation</span> <span class="comment">could</span> <span class="comment">be</span> <span class="comment">made</span><span class="comment">.</span>
<span class="line-number">474</span>      <span class="comment">*/</span>
<span class="line-number">475</span>     <span class="keyword-directive">private</span> <span class="keyword-directive">boolean</span> attemptToRotateCurrent(<span class="keyword-directive">boolean</span> clockwise) {
<span class="line-number">476</span>         <span class="keyword-directive">if</span> (clockwise) {
<span class="line-number">477</span>             current.rotateClockwise();
<span class="line-number">478</span>             <span class="keyword-directive">boolean</span> overlap = checkIfCurrentIntersectsPile();
<span class="line-number">479</span>             <span class="keyword-directive">if</span> (overlap) {
<span class="line-number">480</span>                 current.rotateCounterClockwise();
<span class="line-number">481</span>             }
<span class="line-number">482</span>         }
<span class="line-number">483</span>         <span class="keyword-directive">else</span> {
<span class="line-number">484</span>             current.rotateCounterClockwise();
<span class="line-number">485</span>             <span class="keyword-directive">boolean</span> overlap = checkIfCurrentIntersectsPile();
<span class="line-number">486</span>             <span class="keyword-directive">if</span> (overlap) {
<span class="line-number">487</span>                 current.rotateClockwise();
<span class="line-number">488</span>             }
<span class="line-number">489</span>         }
<span class="line-number">490</span>         <span class="keyword-directive">return</span> <span class="keyword-directive">true</span>;
<span class="line-number">491</span>     }
<span class="line-number">492</span> 
<span class="line-number">493</span>     <span class="comment">/**</span>
<span class="line-number">494</span> <span class="comment">     * </span><span class="comment">Handles</span> <span class="comment">actions</span> <span class="comment">based</span> <span class="comment">on</span> <span class="comment">the</span> <span class="comment">provided</span> <span class="comment">identifier</span> <span class="comment">and</span> <span class="comment">paints</span>
<span class="line-number">495</span> <span class="comment">     * </span><span class="comment">appropriately</span><span class="comment">.</span>
<span class="line-number">496</span> <span class="comment">     * </span><span class="ST0">@param</span> <span class="comment">identifier</span> <span class="comment">String</span> <span class="comment">representing</span> <span class="comment">requested</span> <span class="comment">action</span><span class="comment">.</span>
<span class="line-number">497</span>      <span class="comment">*/</span>
<span class="line-number">498</span>     <span class="keyword-directive">private</span> <span class="keyword-directive">void</span> throwAction(String identifier) {
<span class="line-number">499</span>         <span class="keyword-directive">if</span> (!paused) {
<span class="line-number">500</span>             <span class="keyword-directive">boolean</span> actionSuccess = <span class="keyword-directive">false</span>;
<span class="line-number">501</span>             Tetra oldTetra = current.cloneMethod();
<span class="line-number">502</span>             <span class="keyword-directive">if</span> (identifier.equals(<span class="character">&quot;</span><span class="character">step</span><span class="character">&quot;</span>)) {
<span class="line-number">503</span>                 actionSuccess = attemptToMoveCurrentDown();
<span class="line-number">504</span>             }
<span class="line-number">505</span>             <span class="keyword-directive">if</span> (identifier.equals(<span class="character">&quot;</span><span class="character">left</span><span class="character">&quot;</span>)) {
<span class="line-number">506</span>                 actionSuccess = attemptToMoveCurrentLeft();
<span class="line-number">507</span>             }
<span class="line-number">508</span>             <span class="keyword-directive">if</span> (identifier.equals(<span class="character">&quot;</span><span class="character">right</span><span class="character">&quot;</span>)) {
<span class="line-number">509</span>                 actionSuccess = attemptToMoveCurrentRight();
<span class="line-number">510</span>             }
<span class="line-number">511</span>             <span class="keyword-directive">if</span> (identifier.equals(<span class="character">&quot;</span><span class="character">down</span><span class="character">&quot;</span>)) {
<span class="line-number">512</span>                 actionSuccess = attemptToMoveCurrentToMaximumDownwardPosition();
<span class="line-number">513</span>             }
<span class="line-number">514</span>             <span class="keyword-directive">if</span> (identifier.equals(<span class="character">&quot;</span><span class="character">cwr</span><span class="character">&quot;</span>)) {
<span class="line-number">515</span>                 actionSuccess = attemptToRotateCurrent(<span class="keyword-directive">true</span>);
<span class="line-number">516</span>             }
<span class="line-number">517</span>             <span class="keyword-directive">if</span> (identifier.equals(<span class="character">&quot;</span><span class="character">ccwr</span><span class="character">&quot;</span>)) {
<span class="line-number">518</span>                 actionSuccess = attemptToRotateCurrent(<span class="keyword-directive">false</span>);
<span class="line-number">519</span>             }
<span class="line-number">520</span>             <span class="keyword-directive">if</span> (actionSuccess) {
<span class="line-number">521</span>                 paintCurrent(oldTetra);
<span class="line-number">522</span>             }
<span class="line-number">523</span>             checkGameOver();
<span class="line-number">524</span>             <span class="keyword-directive">if</span> (gameOver) {
<span class="line-number">525</span>                 paintComponent(<span class="keyword-directive">this</span>.getGraphics());
<span class="line-number">526</span>             }
<span class="line-number">527</span>         }
<span class="line-number">528</span>     }
<span class="line-number">529</span> 
<span class="line-number">530</span>     <span class="comment">/**</span>
<span class="line-number">531</span> <span class="comment">     * </span><span class="comment">Determines</span> <span class="comment">if</span> <span class="comment">given</span> <span class="comment">Set</span> <span class="comment">of</span> <span class="comment">Blocks</span> <span class="comment">contains</span> <span class="comment">a</span> <span class="comment">Block</span> <span class="comment">equivalent</span> <span class="comment">to</span> <span class="comment">the</span>
<span class="line-number">532</span> <span class="comment">     * </span><span class="comment">given</span> <span class="comment">target</span> <span class="comment">Block</span><span class="comment">.</span>  <span class="comment">Equivalency</span> <span class="comment">is</span> <span class="comment">not</span> <span class="comment">based</span> <span class="comment">on</span> <span class="comment">default</span> <span class="comment">hash</span>
<span class="line-number">533</span> <span class="comment">     * </span><span class="comment">equivalency</span><span class="comment">, </span><span class="comment">but</span> <span class="comment">on</span> <span class="comment">the</span> <span class="comment">custom</span> <span class="comment">comparator</span> <span class="comment">defined</span> <span class="comment">in</span> <span class="comment">the</span> <span class="comment">Block</span> <span class="comment">class</span><span class="comment">.</span>
<span class="line-number">534</span> <span class="comment">     * </span><span class="ST0">@param</span> <span class="comment">set</span> <span class="comment">Set</span> <span class="comment">to</span> <span class="comment">be</span> <span class="comment">searched</span>
<span class="line-number">535</span> <span class="comment">     * </span><span class="ST0">@param</span> <span class="comment">target</span> <span class="comment">Search</span> <span class="comment">element</span><span class="comment">.</span>
<span class="line-number">536</span> <span class="comment">     * </span><span class="ST0">@return</span> <span class="comment">True</span> <span class="comment">if</span> <span class="comment">the</span> <span class="comment">Block</span> <span class="comment">was</span> <span class="comment">found</span><span class="comment">, </span><span class="comment">otherwise</span> <span class="comment">false</span>
<span class="line-number">537</span>      <span class="comment">*/</span>
<span class="line-number">538</span>     <span class="keyword-directive">private</span> <span class="keyword-directive">static</span> <span class="keyword-directive">boolean</span> setContains(Set&lt;Block&gt; set,
<span class="line-number">539</span>                                        Block target) {
<span class="line-number">540</span>         <span class="keyword-directive">for</span> (Block b : set) {
<span class="line-number">541</span>             <span class="keyword-directive">if</span> (b.equals(target)) {
<span class="line-number">542</span>                 <span class="keyword-directive">return</span> <span class="keyword-directive">true</span>;
<span class="line-number">543</span>             }
<span class="line-number">544</span>         }
<span class="line-number">545</span>         <span class="keyword-directive">return</span> <span class="keyword-directive">false</span>;
<span class="line-number">546</span>     }
<span class="line-number">547</span> 
<span class="line-number">548</span>     <span class="comment">/**</span>
<span class="line-number">549</span> <span class="comment">     * </span><span class="comment">Pseudorandomly</span> <span class="comment">generates</span> <span class="comment">a</span> <span class="comment">new</span> <span class="comment">Tetra</span> <span class="comment">from</span> <span class="comment">one</span> <span class="comment">of</span> <span class="comment">the</span> <span class="comment">predefined</span> <span class="comment">options</span><span class="comment">.</span>
<span class="line-number">550</span> <span class="comment">     * </span><span class="ST0">@see</span> <span class="comment">java</span><span class="comment">.</span><span class="comment">util</span><span class="comment">.</span><span class="comment">Random</span>
<span class="line-number">551</span> <span class="comment">     * </span><span class="ST0">@return</span> <span class="comment">a</span> <span class="comment">Tetra</span>
<span class="line-number">552</span>      <span class="comment">*/</span>
<span class="line-number">553</span>     <span class="keyword-directive">private</span> Tetra generateTetra() {
<span class="line-number">554</span>         Random generator = <span class="keyword-directive">new</span> Random();
<span class="line-number">555</span>         <span class="keyword-directive">int</span> random = generator.nextInt(Tetra.NUMBER_OF_TETRAS);
<span class="line-number">556</span>         <span class="keyword-directive">return</span> <span class="keyword-directive">new</span> Tetra(Tetra.TETRA_IDENTIFIERS[random]);
<span class="line-number">557</span>     }
<span class="line-number">558</span> 
<span class="line-number">559</span>     <span class="comment">/**</span>
<span class="line-number">560</span> <span class="comment">     * </span><span class="comment">Convenience</span> <span class="comment">function</span> <span class="comment">that</span> <span class="comment">handles</span> <span class="comment">singular</span> <span class="comment">vertical</span> <span class="comment">movement</span> <span class="comment">of</span> <span class="comment">the</span>
<span class="line-number">561</span> <span class="comment">     * </span><span class="comment">current</span> <span class="comment">Tetra</span><span class="comment">.</span>
<span class="line-number">562</span> <span class="comment">     * </span><span class="ST0">@return</span> <span class="comment">whether</span> <span class="comment">or</span> <span class="comment">not</span> <span class="comment">the</span> <span class="comment">movement</span> <span class="comment">was</span> <span class="comment">successful</span><span class="comment">.</span>
<span class="line-number">563</span>      <span class="comment">*/</span>
<span class="line-number">564</span>     <span class="keyword-directive">private</span> <span class="keyword-directive">boolean</span> attemptToMoveCurrentDown() {
<span class="line-number">565</span>         <span class="keyword-directive">return</span> attemptToMoveCurrent(0);
<span class="line-number">566</span>     }
<span class="line-number">567</span> 
<span class="line-number">568</span>     <span class="comment">/**</span>
<span class="line-number">569</span> <span class="comment">     * </span><span class="comment">Convenience</span> <span class="comment">function</span> <span class="comment">that</span> <span class="comment">handles</span> <span class="comment">singular</span> <span class="comment">leftward</span> <span class="comment">movement</span> <span class="comment">of</span> <span class="comment">the</span>
<span class="line-number">570</span> <span class="comment">     * </span><span class="comment">current</span> <span class="comment">Tetra</span><span class="comment">.</span>
<span class="line-number">571</span> <span class="comment">     * </span><span class="ST0">@return</span> <span class="comment">whether</span> <span class="comment">or</span> <span class="comment">not</span> <span class="comment">the</span> <span class="comment">movement</span> <span class="comment">was</span> <span class="comment">successful</span>
<span class="line-number">572</span>      <span class="comment">*/</span>
<span class="line-number">573</span>     <span class="keyword-directive">private</span> <span class="keyword-directive">boolean</span> attemptToMoveCurrentLeft() {
<span class="line-number">574</span>         <span class="keyword-directive">return</span> attemptToMoveCurrent(-1);
<span class="line-number">575</span>     }
<span class="line-number">576</span> 
<span class="line-number">577</span>     <span class="comment">/**</span>
<span class="line-number">578</span> <span class="comment">     * </span><span class="comment">Convenience</span> <span class="comment">function</span> <span class="comment">that</span> <span class="comment">handles</span> <span class="comment">singular</span> <span class="comment">rightward</span> <span class="comment">movement</span> <span class="comment">of</span> <span class="comment">the</span>
<span class="line-number">579</span> <span class="comment">     * </span><span class="comment">current</span> <span class="comment">Tetra</span><span class="comment">.</span>
<span class="line-number">580</span> <span class="comment">     * </span><span class="ST0">@return</span> <span class="comment">whether</span> <span class="comment">or</span> <span class="comment">not</span> <span class="comment">the</span> <span class="comment">movement</span> <span class="comment">was</span> <span class="comment">successful</span>
<span class="line-number">581</span>      <span class="comment">*/</span>
<span class="line-number">582</span>     <span class="keyword-directive">private</span> <span class="keyword-directive">boolean</span> attemptToMoveCurrentRight() {
<span class="line-number">583</span>         <span class="keyword-directive">return</span> attemptToMoveCurrent(1);
<span class="line-number">584</span>     }
<span class="line-number">585</span> 
<span class="line-number">586</span>     <span class="comment">/**</span>
<span class="line-number">587</span> <span class="comment">     * </span><span class="comment">Allows</span> <span class="comment">an</span> <span class="comment">external</span> <span class="comment">function</span> <span class="comment">to</span> <span class="comment">indicate</span> <span class="comment">to</span> <span class="comment">throwAction</span><span class="comment">() </span><span class="comment">that</span> <span class="comment">a</span>
<span class="line-number">588</span> <span class="comment">     * </span><span class="comment">step</span> <span class="comment">action</span> <span class="comment">should</span> <span class="comment">occur</span> <span class="comment">without</span> <span class="comment">knowledge</span> <span class="comment">of</span> <span class="comment">the</span> <span class="comment">appropriate</span> <span class="comment">identifier</span><span class="comment">.</span>
<span class="line-number">589</span>      <span class="comment">*/</span>
<span class="line-number">590</span>     <span class="keyword-directive">public</span> <span class="keyword-directive">void</span> throwStepAction() {
<span class="line-number">591</span>         throwAction(<span class="character">&quot;</span><span class="character">step</span><span class="character">&quot;</span>);
<span class="line-number">592</span>     }
<span class="line-number">593</span> 
<span class="line-number">594</span>     <span class="comment">/**</span>
<span class="line-number">595</span> <span class="comment">     * </span><span class="comment">Allows</span> <span class="comment">an</span> <span class="comment">external</span> <span class="comment">function</span> <span class="comment">to</span> <span class="comment">indicate</span> <span class="comment">to</span> <span class="comment">throwAction</span><span class="comment">() </span><span class="comment">that</span> <span class="comment">a</span>
<span class="line-number">596</span> <span class="comment">     * </span><span class="comment">leftward</span> <span class="comment">action</span> <span class="comment">should</span> <span class="comment">occur</span> <span class="comment">without</span> <span class="comment">knowledge</span> <span class="comment">of</span> <span class="comment">the</span> <span class="comment">appropriate</span>
<span class="line-number">597</span> <span class="comment">     * </span><span class="comment">identifier</span><span class="comment">.</span>
<span class="line-number">598</span>      <span class="comment">*/</span>
<span class="line-number">599</span>     <span class="keyword-directive">public</span> <span class="keyword-directive">void</span> throwLeftwardAction() {
<span class="line-number">600</span>         throwAction(<span class="character">&quot;</span><span class="character">left</span><span class="character">&quot;</span>);
<span class="line-number">601</span>     }
<span class="line-number">602</span> 
<span class="line-number">603</span>     <span class="comment">/**</span>
<span class="line-number">604</span> <span class="comment">     * </span><span class="comment">Allows</span> <span class="comment">an</span> <span class="comment">external</span> <span class="comment">function</span> <span class="comment">to</span> <span class="comment">indicate</span> <span class="comment">to</span> <span class="comment">throwAction</span><span class="comment">() </span><span class="comment">that</span> <span class="comment">a</span>
<span class="line-number">605</span> <span class="comment">     * </span><span class="comment">rightward</span> <span class="comment">action</span> <span class="comment">should</span> <span class="comment">occur</span> <span class="comment">without</span> <span class="comment">knowledge</span> <span class="comment">of</span> <span class="comment">the</span> <span class="comment">appropriate</span>
<span class="line-number">606</span> <span class="comment">     * </span><span class="comment">identifier</span><span class="comment">.</span>
<span class="line-number">607</span>      <span class="comment">*/</span>
<span class="line-number">608</span>     <span class="keyword-directive">public</span> <span class="keyword-directive">void</span> throwRightwardAction() {
<span class="line-number">609</span>         throwAction(<span class="character">&quot;</span><span class="character">right</span><span class="character">&quot;</span>);
<span class="line-number">610</span>     }
<span class="line-number">611</span> 
<span class="line-number">612</span>     <span class="comment">/**</span>
<span class="line-number">613</span> <span class="comment">     * </span><span class="comment">Allows</span> <span class="comment">an</span> <span class="comment">external</span> <span class="comment">function</span> <span class="comment">to</span> <span class="comment">indicate</span> <span class="comment">to</span> <span class="comment">throwAction</span><span class="comment">() </span><span class="comment">that</span> <span class="comment">a</span>
<span class="line-number">614</span> <span class="comment">     * </span><span class="comment">downward</span> <span class="comment">action</span> <span class="comment">should</span> <span class="comment">occur</span> <span class="comment">without</span> <span class="comment">knowledge</span> <span class="comment">of</span> <span class="comment">the</span> <span class="comment">appropriate</span>
<span class="line-number">615</span> <span class="comment">     * </span><span class="comment">identifier</span><span class="comment">.</span>
<span class="line-number">616</span>      <span class="comment">*/</span>
<span class="line-number">617</span>     <span class="keyword-directive">public</span> <span class="keyword-directive">void</span> throwDownwardAction() {
<span class="line-number">618</span>         throwAction(<span class="character">&quot;</span><span class="character">down</span><span class="character">&quot;</span>);
<span class="line-number">619</span>     }
<span class="line-number">620</span> 
<span class="line-number">621</span>     <span class="comment">/**</span>
<span class="line-number">622</span> <span class="comment">     * </span><span class="comment">Allows</span> <span class="comment">an</span> <span class="comment">external</span> <span class="comment">function</span> <span class="comment">to</span> <span class="comment">indicate</span> <span class="comment">to</span> <span class="comment">throwAction</span><span class="comment">() </span><span class="comment">that</span> <span class="comment">a</span>
<span class="line-number">623</span> <span class="comment">     * </span><span class="comment">clockwise</span> <span class="comment">rotation</span> <span class="comment">action</span> <span class="comment">should</span> <span class="comment">occur</span> <span class="comment">without</span> <span class="comment">knowledge</span> <span class="comment">of</span> <span class="comment">the</span>
<span class="line-number">624</span> <span class="comment">     * </span><span class="comment">appropriate</span> <span class="comment">identifier</span><span class="comment">.</span>
<span class="line-number">625</span>      <span class="comment">*/</span>
<span class="line-number">626</span>     <span class="keyword-directive">public</span> <span class="keyword-directive">void</span> throwClockwiseRotationAction() {
<span class="line-number">627</span>         throwAction(<span class="character">&quot;</span><span class="character">cwr</span><span class="character">&quot;</span>);
<span class="line-number">628</span>     }
<span class="line-number">629</span> 
<span class="line-number">630</span>     <span class="comment">/**</span>
<span class="line-number">631</span> <span class="comment">     * </span><span class="comment">Allows</span> <span class="comment">an</span> <span class="comment">external</span> <span class="comment">function</span> <span class="comment">to</span> <span class="comment">indicate</span> <span class="comment">to</span> <span class="comment">throwAction</span><span class="comment">() </span><span class="comment">that</span> <span class="comment">a</span>
<span class="line-number">632</span> <span class="comment">     * </span><span class="comment">counter</span> <span class="comment">clockwise</span> <span class="comment">rotation</span> <span class="comment">action</span> <span class="comment">should</span> <span class="comment">occur</span> <span class="comment">without</span> <span class="comment">knowledge</span> <span class="comment">of</span> <span class="comment">the</span>
<span class="line-number">633</span> <span class="comment">     * </span><span class="comment">appropriate</span> <span class="comment">identifier</span><span class="comment">.</span>
<span class="line-number">634</span>      <span class="comment">*/</span>
<span class="line-number">635</span>     <span class="keyword-directive">public</span> <span class="keyword-directive">void</span> throwCounterClockwiseRotationAction() {
<span class="line-number">636</span>         throwAction(<span class="character">&quot;</span><span class="character">ccwr</span><span class="character">&quot;</span>);
<span class="line-number">637</span>     }
<span class="line-number">638</span> 
<span class="line-number">639</span>     <span class="comment">/**</span>
<span class="line-number">640</span> <span class="comment">     * </span><span class="comment">Dialog</span> <span class="comment">for</span> <span class="comment">new</span> <span class="comment">high</span> <span class="comment">scorer</span><span class="comment">.</span> <span class="comment">Forces</span> <span class="comment">user</span> <span class="comment">to</span> <span class="comment">input</span> <span class="comment">name</span> <span class="comment">and</span> <span class="comment">passes</span>
<span class="line-number">641</span> <span class="comment">     * </span><span class="comment">appropriate</span> <span class="comment">data</span> <span class="comment">to</span> <span class="comment">the</span> <span class="comment">HighScore</span><span class="comment">.</span>
<span class="line-number">642</span>      <span class="comment">*/</span>
<span class="line-number">643</span>     <span class="keyword-directive">private</span> <span class="keyword-directive">class</span> HighScoreFrame <span class="keyword-directive">extends</span> JFrame {
<span class="line-number">644</span> 
<span class="line-number">645</span>         <span class="keyword-directive">private</span> JTextField nameField;
<span class="line-number">646</span>         <span class="keyword-directive">private</span> JButton okButton;
<span class="line-number">647</span>         <span class="keyword-directive">private</span> JLabel message;
<span class="line-number">648</span> 
<span class="line-number">649</span>         <span class="comment">/**</span>
<span class="line-number">650</span> <span class="comment">         * </span><span class="comment">Constructs</span> <span class="comment">a</span> <span class="comment">new</span> <span class="comment">dialog</span><span class="comment">.</span>
<span class="line-number">651</span>          <span class="comment">*/</span>
<span class="line-number">652</span>         <span class="keyword-directive">public</span> HighScoreFrame() {
<span class="line-number">653</span>             gameOver = <span class="keyword-directive">false</span>;
<span class="line-number">654</span>             pause();
<span class="line-number">655</span>             <span class="keyword-directive">this</span>.setSize(300,
<span class="line-number">656</span>                          200);
<span class="line-number">657</span>             message = <span class="keyword-directive">new</span> JLabel(<span class="character">&quot;</span><span class="character">New High Score! Enter Your Name:</span><span class="character">&quot;</span>);
<span class="line-number">658</span>             nameField = <span class="keyword-directive">new</span> JTextField();
<span class="line-number">659</span>             okButton = <span class="keyword-directive">new</span> JButton(<span class="character">&quot;</span><span class="character">OK</span><span class="character">&quot;</span>);
<span class="line-number">660</span>             okButton.addActionListener(<span class="keyword-directive">new</span> OkButtonActionListener());
<span class="line-number">661</span>             <span class="keyword-directive">this</span>.setLayout(<span class="keyword-directive">new</span> GridLayout(3,
<span class="line-number">662</span>                                           1));
<span class="line-number">663</span>             <span class="keyword-directive">this</span>.add(message);
<span class="line-number">664</span>             <span class="keyword-directive">this</span>.add(nameField);
<span class="line-number">665</span>             <span class="keyword-directive">this</span>.add(okButton);
<span class="line-number">666</span>             <span class="keyword-directive">this</span>.setDefaultCloseOperation(JFrame.DO_NOTHING_ON_CLOSE);
<span class="line-number">667</span>         }
<span class="line-number">668</span> 
<span class="line-number">669</span>         <span class="comment">/**</span>
<span class="line-number">670</span> <span class="comment">         * </span><span class="comment">Called</span> <span class="comment">when</span> <span class="comment">the</span> <span class="comment">done</span> <span class="comment">button</span> <span class="comment">is</span> <span class="comment">pressed</span><span class="comment">.</span> <span class="comment">Determines</span> <span class="comment">if</span> <span class="comment">a</span> <span class="comment">valid</span>
<span class="line-number">671</span> <span class="comment">         * </span><span class="comment">entry</span> <span class="comment">is</span> <span class="comment">present</span><span class="comment">.</span> <span class="comment">If</span> <span class="comment">not</span><span class="comment">, </span><span class="comment">returns</span> <span class="comment">early</span><span class="comment">.</span> <span class="comment">If</span> <span class="comment">entry</span> <span class="comment">is</span> <span class="comment">valid</span><span class="comment">,</span>
<span class="line-number">672</span> <span class="comment">         * </span><span class="comment">passes</span> <span class="comment">appropriate</span> <span class="comment">data</span> <span class="comment">to</span> <span class="comment">the</span> <span class="comment">HighScore</span><span class="comment">.</span>
<span class="line-number">673</span>          <span class="comment">*/</span>
<span class="line-number">674</span>         <span class="keyword-directive">private</span> <span class="keyword-directive">void</span> done() {
<span class="line-number">675</span>             <span class="keyword-directive">if</span> (nameField.getText().equals(<span class="character">&quot;&quot;</span>)) {
<span class="line-number">676</span>                 <span class="keyword-directive">new</span> JOptionPane(<span class="character">&quot;</span><span class="character">Enter a valid name.</span><span class="character">&quot;</span>).createDialog(<span class="keyword-directive">this</span>,
<span class="line-number">677</span>                                                                     <span class="character">&quot;</span><span class="character">Invalid Entry</span><span class="character">&quot;</span>).setVisible(
<span class="line-number">678</span>                         <span class="keyword-directive">true</span>);
<span class="line-number">679</span>                 <span class="keyword-directive">return</span>;
<span class="line-number">680</span>             }
<span class="line-number">681</span>             String scoreString = score + <span class="character">&quot;&quot;</span>;
<span class="line-number">682</span>             <span class="keyword-directive">int</span> maxNameSize =
<span class="line-number">683</span>                 MAX_CHARS_ON_HIGH_SCORE_LINE - 2 - scoreString.length();
<span class="line-number">684</span>             <span class="keyword-directive">if</span> (nameField.getText().length() &gt; maxNameSize) {
<span class="line-number">685</span>                 <span class="keyword-directive">new</span> JOptionPane(<span class="character">&quot;</span><span class="character">Enter a name less than </span><span class="character">&quot;</span> + maxNameSize
<span class="line-number">686</span>                                 + <span class="character">&quot;</span><span class="character"> characters.</span><span class="character">&quot;</span>).createDialog(<span class="keyword-directive">this</span>,
<span class="line-number">687</span>                                                                <span class="character">&quot;</span><span class="character">Invalid Entry</span><span class="character">&quot;</span>).setVisible(
<span class="line-number">688</span>                         <span class="keyword-directive">true</span>);
<span class="line-number">689</span>                 <span class="keyword-directive">return</span>;
<span class="line-number">690</span>             }
<span class="line-number">691</span>             highScoreTable.addListingIfEligible(nameField.getText(),
<span class="line-number">692</span>                                                 score);
<span class="line-number">693</span>             highScoreTable.save();
<span class="line-number">694</span>             <span class="keyword-directive">this</span>.dispose();
<span class="line-number">695</span>             <span class="keyword-directive">this</span>.setVisible(<span class="keyword-directive">false</span>);
<span class="line-number">696</span> 
<span class="line-number">697</span>         }
<span class="line-number">698</span> 
<span class="line-number">699</span>         <span class="comment">/**</span>
<span class="line-number">700</span> <span class="comment">         * </span><span class="comment">Listens</span> <span class="comment">for</span> <span class="comment">ActionEvents</span> <span class="comment">created</span> <span class="comment">when</span> <span class="comment">the</span> <span class="comment">user</span> <span class="comment">presses</span> <span class="comment">ok</span><span class="comment">, </span><span class="comment">and</span>
<span class="line-number">701</span> <span class="comment">         * </span><span class="comment">responds</span> <span class="comment">appropriately</span>
<span class="line-number">702</span>          <span class="comment">*/</span>
<span class="line-number">703</span>         <span class="keyword-directive">private</span> <span class="keyword-directive">class</span> OkButtonActionListener <span class="keyword-directive">implements</span> ActionListener {
<span class="line-number">704</span> 
<span class="line-number">705</span>             <span class="comment">/**</span>
<span class="line-number">706</span> <span class="comment">             * </span><span class="comment">Responds</span> <span class="comment">to</span> <span class="comment">ActionEvent</span><span class="comment">.</span> <span class="comment">Will</span> <span class="comment">only</span> <span class="comment">be</span> <span class="comment">called</span> <span class="comment">when</span> <span class="comment">ok</span> <span class="comment">button</span> <span class="comment">is</span>
<span class="line-number">707</span> <span class="comment">             * </span><span class="comment">pressed</span><span class="comment">.</span>
<span class="line-number">708</span> <span class="comment">             * </span><span class="ST0">@param</span> <span class="comment">e</span> <span class="comment">ActionEvent</span> <span class="comment">created</span> <span class="comment">by</span> <span class="comment">button</span> <span class="comment">press</span>
<span class="line-number">709</span>              <span class="comment">*/</span>
<span class="line-number">710</span>             @Override
<span class="line-number">711</span>             <span class="keyword-directive">public</span> <span class="keyword-directive">void</span> actionPerformed(ActionEvent e) {
<span class="line-number">712</span>                 done();
<span class="line-number">713</span>             }
<span class="line-number">714</span>         }
<span class="line-number">715</span>     }
<span class="line-number">716</span> 
<span class="line-number">717</span>     <span class="comment">/**</span>
<span class="line-number">718</span> <span class="comment">     * </span><span class="comment">Determines</span> <span class="comment">if</span> <span class="comment">the</span> <span class="comment">current</span> <span class="comment">score</span> <span class="comment">qualifies</span> <span class="comment">as</span> <span class="comment">a</span> <span class="comment">high</span> <span class="comment">score</span><span class="comment">.</span> <span class="comment">If</span> <span class="comment">so</span><span class="comment">,</span>
<span class="line-number">719</span> <span class="comment">     * </span><span class="comment">it</span> <span class="comment">opens</span> <span class="comment">a</span> <span class="comment">HighScoreFrame</span> <span class="comment">dialog</span><span class="comment">.</span>
<span class="line-number">720</span>      <span class="comment">*/</span>
<span class="line-number">721</span>     <span class="keyword-directive">private</span> <span class="keyword-directive">void</span> checkHighScorer() {
<span class="line-number">722</span>         <span class="keyword-directive">if</span> (score &lt; highScoreTable.getMinimumToQualify()) {
<span class="line-number">723</span>             <span class="keyword-directive">return</span>;
<span class="line-number">724</span>         }
<span class="line-number">725</span>         <span class="keyword-directive">if</span> (highScoreFrame == <span class="keyword-directive">null</span> || highScoreFrame.isVisible() == <span class="keyword-directive">false</span>) {
<span class="line-number">726</span>             highScoreFrame = <span class="keyword-directive">new</span> HighScoreFrame();
<span class="line-number">727</span>             highScoreFrame.setVisible(<span class="keyword-directive">true</span>);
<span class="line-number">728</span>         }
<span class="line-number">729</span>     }
<span class="line-number">730</span> }
<span class="line-number">731</span> 
<span class="line-number">732</span> 
</pre></body>
</html>
